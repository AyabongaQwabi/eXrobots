//by Denver Daniels (http://www.github.com/denvereezy)
var http = require('http');
var express = require('express'),
    app = module.exports.app = express()
  , io = require('socket.io')
  , five = require("johnny-five"),
  board,sensor;


var server = http.createServer(app);
var io = require('socket.io').listen(server);  //pass a http.Server instance
server.listen(9000);  //
board = new five.Board();


// handle web server
app.use(express.static('public'));

board.on("ready", function() {
   //define sensor
   var sensor = new five.IR.Motion(7);
});
 io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
 
  // if board is ready
  if(board.on){
    // read in sensor data, pass to browser
    sensor.("motionstart", function(err, ts){
      socket.emit('sensor', { raw: this.raw });
    });
  }


});

 // "calibrated" occurs once, at the beginning of a session,
 /* motion.on("calibrated", function(err, ts) {
    console.log("calibrated", ts);
  });

  // "motionstart" events are fired when the "calibrated"
  // Led strobe fast when motion has started
  motion.on("motionstart", function(err, ts) {
    console.log("motionstart", ts);
  });

  // "motionstart" events are fired following a "motionstart event
  // when no movement has occurred led strobe slower in different patterns
  motion.on("motionend", function(err, ts) {
    console.log("motionend", ts);
  });*/


